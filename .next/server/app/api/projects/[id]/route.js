"use strict";(()=>{var e={};e.id=361,e.ids=[361],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},4074:e=>{e.exports=require("perf_hooks")},63477:e=>{e.exports=require("querystring")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},81687:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>L,patchFetch:()=>y,requestAsyncStorage:()=>N,routeModule:()=>_,serverHooks:()=>j,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>A});var o={};r.r(o),r.d(o,{DELETE:()=>g,GET:()=>p,PUT:()=>f});var a=r(95419),n=r(69108),s=r(99678),d=r(78070),l=r(47033),u=r(12030),i=r(12279),c=r(3205);async function p(e,{params:t}){try{let e=await (0,c.I)();if(!e?.user?.id)return d.Z.json({error:"Unauthorized"},{status:401});let r=t.id,o=await l.db.select().from(u.q).where((0,i.xD)((0,i.eq)(u.q.id,r),(0,i.eq)(u.q.userId,e.user.id))).limit(1);if(!o[0])return d.Z.json({error:"Project not found"},{status:404});let a=await l.db.select().from(u.QZ).where((0,i.eq)(u.QZ.projectId,r)).orderBy(u.QZ.path);return d.Z.json({project:o[0],files:a})}catch(e){return console.error("Get project API error:",e),d.Z.json({error:"Internal server error"},{status:500})}}async function f(e,{params:t}){try{let r=await (0,c.I)();if(!r?.user?.id)return d.Z.json({error:"Unauthorized"},{status:401});let o=t.id,a=await e.json(),n=await l.db.update(u.q).set({...a,updatedAt:new Date}).where((0,i.xD)((0,i.eq)(u.q.id,o),(0,i.eq)(u.q.userId,r.user.id))).returning();if(!n[0])return d.Z.json({error:"Project not found"},{status:404});return d.Z.json({success:!0,project:n[0]})}catch(e){return console.error("Update project API error:",e),d.Z.json({error:"Failed to update project",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function g(e,{params:t}){try{let e=await (0,c.I)();if(!e?.user?.id)return d.Z.json({error:"Unauthorized"},{status:401});let r=t.id;if(!(await l.db.delete(u.q).where((0,i.xD)((0,i.eq)(u.q.id,r),(0,i.eq)(u.q.userId,e.user.id))).returning())[0])return d.Z.json({error:"Project not found"},{status:404});return d.Z.json({success:!0,message:"Project deleted successfully"})}catch(e){return console.error("Delete project API error:",e),d.Z.json({error:"Failed to delete project",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let _=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/projects/[id]/route",pathname:"/api/projects/[id]",filename:"route",bundlePath:"app/api/projects/[id]/route"},resolvedPagePath:"C:\\Users\\bunny\\CascadeProjects\\code-doc-gen\\app\\api\\projects\\[id]\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:N,staticGenerationAsyncStorage:m,serverHooks:j,headerHooks:h,staticGenerationBailout:A}=_,L="/api/projects/[id]/route";function y(){return(0,s.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:m})}},4118:(e,t,r)=>{r.r(t),r.d(t,{GET:()=>l,POST:()=>l,authOptions:()=>d});var o=r(81355),a=r.n(o),n=r(10375),s=r(79390);let d={providers:[(0,n.Z)({clientId:process.env.GOOGLE_CLIENT_ID||"",clientSecret:process.env.GOOGLE_CLIENT_SECRET||""}),(0,s.Z)({clientId:process.env.DISCORD_CLIENT_ID||"",clientSecret:process.env.DISCORD_CLIENT_SECRET||""})],callbacks:{session:async({session:e,token:t})=>(e.user.id=t.sub,e)},secret:process.env.NEXTAUTH_SECRET,pages:{signIn:"/login"}},l=a()(d)},3205:(e,t,r)=>{r.d(t,{I:()=>n});var o=r(49605),a=r(4118);async function n(){return await (0,o.getServerSession)(a.authOptions)}},47033:(e,t,r)=>{r.d(t,{db:()=>d});var o=r(37939),a=r(25669);let n=process.env.DATABASE_URL;if(!n)throw Error("DATABASE_URL is not set");let s=(0,a.Z)(n),d=(0,o.t)(s)},12030:(e,t,r)=>{r.d(t,{QZ:()=>g,ed:()=>_,j_:()=>m,q:()=>f,zd:()=>N});var o=r(96155),a=r(49703),n=r(81930),s=r(82561),d=r(56664),l=r(6402),u=r(70573),i=r(75887),c=r(42310);let p=(0,o.af)("users",{id:(0,a.Vj)("id").defaultRandom().primaryKey(),name:(0,n.L7)("name",{length:255}),email:(0,n.L7)("email",{length:255}).notNull().unique(),emailVerified:(0,s.AB)("email_verified"),image:(0,n.L7)("image",{length:255}),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()});(0,o.af)("accounts",{id:(0,a.Vj)("id").defaultRandom().primaryKey(),userId:(0,a.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),type:(0,n.L7)("type",{length:50}).notNull(),provider:(0,n.L7)("provider",{length:50}).notNull(),providerAccountId:(0,n.L7)("provider_account_id",{length:255}).notNull(),refresh_token:(0,d.fL)("refresh_token"),access_token:(0,d.fL)("access_token"),expires_at:(0,l._L)("expires_at"),token_type:(0,n.L7)("token_type",{length:50}),scope:(0,d.fL)("scope"),id_token:(0,d.fL)("id_token"),session_state:(0,d.fL)("session_state"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),(0,o.af)("sessions",{id:(0,a.Vj)("id").defaultRandom().primaryKey(),sessionToken:(0,n.L7)("session_token",{length:255}).notNull().unique(),userId:(0,a.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),expires:(0,s.AB)("expires").notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()});let f=(0,o.af)("projects",{id:(0,a.Vj)("id").defaultRandom().primaryKey(),userId:(0,a.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),name:(0,n.L7)("name",{length:255}).notNull(),description:(0,d.fL)("description"),type:(0,n.L7)("type",{length:50}).notNull(),language:(0,n.L7)("language",{length:100}),framework:(0,n.L7)("framework",{length:100}),prompt:(0,d.fL)("prompt").notNull(),settings:(0,u.JB)("settings"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),g=(0,o.af)("files",{id:(0,a.Vj)("id").defaultRandom().primaryKey(),projectId:(0,a.Vj)("project_id").notNull().references(()=>f.id,{onDelete:"cascade"}),name:(0,n.L7)("name",{length:255}).notNull(),path:(0,n.L7)("path",{length:500}).notNull(),type:(0,n.L7)("type",{length:50}).notNull(),language:(0,n.L7)("language",{length:100}),content:(0,d.fL)("content").notNull(),size:(0,l._L)("size").notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),_=(0,o.af)("generations",{id:(0,a.Vj)("id").defaultRandom().primaryKey(),userId:(0,a.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),projectId:(0,a.Vj)("project_id").references(()=>f.id,{onDelete:"cascade"}),prompt:(0,d.fL)("prompt").notNull(),type:(0,n.L7)("type",{length:50}).notNull(),settings:(0,u.JB)("settings"),status:(0,n.L7)("status",{length:50}).notNull().default("pending"),tokensUsed:(0,l._L)("tokens_used").default(0),cost:(0,l._L)("cost").default(0),error:(0,d.fL)("error"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull(),completedAt:(0,s.AB)("completed_at")}),N=(0,o.af)("templates",{id:(0,a.Vj)("id").defaultRandom().primaryKey(),name:(0,n.L7)("name",{length:255}).notNull(),description:(0,d.fL)("description"),category:(0,n.L7)("category",{length:100}).notNull(),language:(0,n.L7)("language",{length:100}),difficulty:(0,n.L7)("difficulty",{length:50}).notNull(),prompt:(0,d.fL)("prompt").notNull(),settings:(0,u.JB)("settings"),hasCode:(0,i.O7)("has_code").default(!0),hasDocs:(0,i.O7)("has_docs").default(!0),downloads:(0,l._L)("downloads").default(0),rating:(0,l._L)("rating").default(0),isPublic:(0,i.O7)("is_public").default(!0),isOfficial:(0,i.O7)("is_official").default(!1),createdBy:(0,a.Vj)("created_by").references(()=>p.id),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),m=(0,o.af)("usage",{id:(0,a.Vj)("id").defaultRandom().primaryKey(),userId:(0,a.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),date:(0,s.AB)("date").notNull(),generations:(0,l._L)("generations").default(0),tokensUsed:(0,l._L)("tokens_used").default(0),cost:(0,l._L)("cost").default(0),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()});(0,c.fC)(p),(0,c.IO)(p),(0,c.fC)(f),(0,c.IO)(f),(0,c.fC)(g),(0,c.IO)(g),(0,c.fC)(_),(0,c.IO)(_),(0,c.fC)(N),(0,c.IO)(N),(0,c.fC)(m),(0,c.IO)(m)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,206,721,279,754],()=>r(81687));module.exports=o})();