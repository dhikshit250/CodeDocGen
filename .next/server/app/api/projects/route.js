"use strict";(()=>{var e={};e.id=871,e.ids=[871],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},4074:e=>{e.exports=require("perf_hooks")},63477:e=>{e.exports=require("querystring")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},12194:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>L,originalPathname:()=>q,patchFetch:()=>I,requestAsyncStorage:()=>h,routeModule:()=>N,serverHooks:()=>y,staticGenerationAsyncStorage:()=>A,staticGenerationBailout:()=>j});var a={};r.r(a),r.d(a,{GET:()=>_,POST:()=>m});var o=r(95419),n=r(69108),s=r(99678),d=r(78070),l=r(47033),i=r(12030),u=r(12279),c=r(36462),p=r(3205),f=r(65256);let g=f.Ry({name:f.Z_().min(1,"Project name is required"),description:f.Z_().optional(),type:f.Km(["code","docs","both"]),language:f.Z_().optional(),framework:f.Z_().optional(),prompt:f.Z_().min(1,"Prompt is required"),settings:f.Ry({includeTests:f.O7().default(!1),includeDiagrams:f.O7().default(!1),addComments:f.O7().default(!0)}).optional()});async function _(e){try{let t=await (0,p.I)();if(!t?.user?.id)return d.Z.json({error:"Unauthorized"},{status:401});let{searchParams:r}=new URL(e.url),a=parseInt(r.get("page")||"1"),o=parseInt(r.get("limit")||"10"),n=r.get("search")||"",s=(0,u.eq)(i.q.userId,t.user.id);n&&(s=(0,u.xD)((0,u.eq)(i.q.userId,t.user.id)));let f=await l.db.select({id:i.q.id,name:i.q.name,description:i.q.description,type:i.q.type,language:i.q.language,framework:i.q.framework,createdAt:i.q.createdAt,updatedAt:i.q.updatedAt,_count:{files:l.db.select().from(i.QZ).where((0,u.eq)(i.QZ.projectId,i.q.id)).then(e=>e.length)}}).from(i.q).where(s).orderBy((0,c.C)(i.q.updatedAt)).limit(o).offset((a-1)*o);return d.Z.json({projects:f,pagination:{page:a,limit:o,total:f.length}})}catch(e){return console.error("Get projects API error:",e),d.Z.json({error:"Internal server error"},{status:500})}}async function m(e){try{let t=await (0,p.I)();if(!t?.user?.id)return d.Z.json({error:"Unauthorized"},{status:401});let r=await e.json(),a=g.parse(r),o=await l.db.insert(i.q).values({userId:t.user.id,...a}).returning();return d.Z.json({success:!0,project:o[0]})}catch(e){return console.error("Create project API error:",e),d.Z.json({error:"Failed to create project",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let N=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/projects/route",pathname:"/api/projects",filename:"route",bundlePath:"app/api/projects/route"},resolvedPagePath:"C:\\Users\\bunny\\CascadeProjects\\code-doc-gen\\app\\api\\projects\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:A,serverHooks:y,headerHooks:L,staticGenerationBailout:j}=N,q="/api/projects/route";function I(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:A})}},4118:(e,t,r)=>{r.r(t),r.d(t,{GET:()=>l,POST:()=>l,authOptions:()=>d});var a=r(81355),o=r.n(a),n=r(10375),s=r(79390);let d={providers:[(0,n.Z)({clientId:process.env.GOOGLE_CLIENT_ID||"",clientSecret:process.env.GOOGLE_CLIENT_SECRET||""}),(0,s.Z)({clientId:process.env.DISCORD_CLIENT_ID||"",clientSecret:process.env.DISCORD_CLIENT_SECRET||""})],callbacks:{session:async({session:e,token:t})=>(e.user.id=t.sub,e)},secret:process.env.NEXTAUTH_SECRET,pages:{signIn:"/login"}},l=o()(d)},3205:(e,t,r)=>{r.d(t,{I:()=>n});var a=r(49605),o=r(4118);async function n(){return await (0,a.getServerSession)(o.authOptions)}},47033:(e,t,r)=>{r.d(t,{db:()=>d});var a=r(37939),o=r(25669);let n=process.env.DATABASE_URL;if(!n)throw Error("DATABASE_URL is not set");let s=(0,o.Z)(n),d=(0,a.t)(s)},12030:(e,t,r)=>{r.d(t,{QZ:()=>g,ed:()=>_,j_:()=>N,q:()=>f,zd:()=>m});var a=r(96155),o=r(49703),n=r(81930),s=r(82561),d=r(56664),l=r(6402),i=r(70573),u=r(75887),c=r(42310);let p=(0,a.af)("users",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),name:(0,n.L7)("name",{length:255}),email:(0,n.L7)("email",{length:255}).notNull().unique(),emailVerified:(0,s.AB)("email_verified"),image:(0,n.L7)("image",{length:255}),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()});(0,a.af)("accounts",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),userId:(0,o.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),type:(0,n.L7)("type",{length:50}).notNull(),provider:(0,n.L7)("provider",{length:50}).notNull(),providerAccountId:(0,n.L7)("provider_account_id",{length:255}).notNull(),refresh_token:(0,d.fL)("refresh_token"),access_token:(0,d.fL)("access_token"),expires_at:(0,l._L)("expires_at"),token_type:(0,n.L7)("token_type",{length:50}),scope:(0,d.fL)("scope"),id_token:(0,d.fL)("id_token"),session_state:(0,d.fL)("session_state"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),(0,a.af)("sessions",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),sessionToken:(0,n.L7)("session_token",{length:255}).notNull().unique(),userId:(0,o.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),expires:(0,s.AB)("expires").notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()});let f=(0,a.af)("projects",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),userId:(0,o.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),name:(0,n.L7)("name",{length:255}).notNull(),description:(0,d.fL)("description"),type:(0,n.L7)("type",{length:50}).notNull(),language:(0,n.L7)("language",{length:100}),framework:(0,n.L7)("framework",{length:100}),prompt:(0,d.fL)("prompt").notNull(),settings:(0,i.JB)("settings"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),g=(0,a.af)("files",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),projectId:(0,o.Vj)("project_id").notNull().references(()=>f.id,{onDelete:"cascade"}),name:(0,n.L7)("name",{length:255}).notNull(),path:(0,n.L7)("path",{length:500}).notNull(),type:(0,n.L7)("type",{length:50}).notNull(),language:(0,n.L7)("language",{length:100}),content:(0,d.fL)("content").notNull(),size:(0,l._L)("size").notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),_=(0,a.af)("generations",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),userId:(0,o.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),projectId:(0,o.Vj)("project_id").references(()=>f.id,{onDelete:"cascade"}),prompt:(0,d.fL)("prompt").notNull(),type:(0,n.L7)("type",{length:50}).notNull(),settings:(0,i.JB)("settings"),status:(0,n.L7)("status",{length:50}).notNull().default("pending"),tokensUsed:(0,l._L)("tokens_used").default(0),cost:(0,l._L)("cost").default(0),error:(0,d.fL)("error"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull(),completedAt:(0,s.AB)("completed_at")}),m=(0,a.af)("templates",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),name:(0,n.L7)("name",{length:255}).notNull(),description:(0,d.fL)("description"),category:(0,n.L7)("category",{length:100}).notNull(),language:(0,n.L7)("language",{length:100}),difficulty:(0,n.L7)("difficulty",{length:50}).notNull(),prompt:(0,d.fL)("prompt").notNull(),settings:(0,i.JB)("settings"),hasCode:(0,u.O7)("has_code").default(!0),hasDocs:(0,u.O7)("has_docs").default(!0),downloads:(0,l._L)("downloads").default(0),rating:(0,l._L)("rating").default(0),isPublic:(0,u.O7)("is_public").default(!0),isOfficial:(0,u.O7)("is_official").default(!1),createdBy:(0,o.Vj)("created_by").references(()=>p.id),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()}),N=(0,a.af)("usage",{id:(0,o.Vj)("id").defaultRandom().primaryKey(),userId:(0,o.Vj)("user_id").notNull().references(()=>p.id,{onDelete:"cascade"}),date:(0,s.AB)("date").notNull(),generations:(0,l._L)("generations").default(0),tokensUsed:(0,l._L)("tokens_used").default(0),cost:(0,l._L)("cost").default(0),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull()});(0,c.fC)(p),(0,c.IO)(p),(0,c.fC)(f),(0,c.IO)(f),(0,c.fC)(g),(0,c.IO)(g),(0,c.fC)(_),(0,c.IO)(_),(0,c.fC)(m),(0,c.IO)(m),(0,c.fC)(N),(0,c.IO)(N)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,206,721,279,754],()=>r(12194));module.exports=a})();